// make a reference to the application (Photoshop)var appRef = '~/Applications/Adobe Photoshop CC 2019'// make a reference to the savedFolder  var savedFolder = new Folder('~/desktop/Landsat/Merged Images');  // create the folder if it doesn't exists  if(!savedFolder.exists) savedFolder.create();  // get the source folder from the user and store in variable  var sourceFolder = Folder.selectDialog();  // make sure user selected a folder  if(sourceFolder != null){      // get an array of red images and store in variable      var sourceFiles = sourceFolder.getFiles(/B3\.tif/i);      // make a loop to process all found sets.      for(var i = 0; i < sourceFiles.length;i++){          var redName = sourceFiles[i].name;          var greenName = redName.replace('B3','B4');          var blueName = redName.replace('B3','B2');        var redImage = open(sourceFiles[i]); // open the red file and store reference to document          var greenImage = open(new File(sourceFolder+'/'+greenName)); // open the green file and store reference that document         var blueImage = open(new File(sourceFolder+'/'+blueName)); // open the blue file and store reference that document         // now apply redImge using lighten mode          merge         // save the merged document          SaveAsTIFF(savedFolder+'/'+redName.replace(/B3.tif$/i,'_merged.tif'),true);          // close the open documents for next loop          redImage.close(SaveOptions.DONOTSAVECHANGES);          greenImage.close(SaveOptions.DONOTSAVECHANGES);        blueImage.close(SaveOptions.DONOTSAVECHANGES);        }  }  function SaveAsTIFF( inFileName, inLZW ) {      var tiffSaveOptions = new TiffSaveOptions();      if ( inLZW ) {          tiffSaveOptions.imageCompression = TIFFEncoding.TIFFLZW;      } else {          tiffSaveOptions.imageCompression = TIFFEncoding.NONE;      }       app.activeDocument.saveAs( File( inFileName ), tiffSaveOptions );  }; 